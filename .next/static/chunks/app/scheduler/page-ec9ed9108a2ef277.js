(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[480],{24997:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>u});var a=l(95155),s=l(12115);let d=(0,l(55647).UU)("https://placeholder.supabase.co","placeholder-anon-key");var n=l(41194),r=l(82940),o=l.n(r);l(33174);let i=(0,n.ye)(o());function c(e){let{events:t,onEventUpdate:l,onEventDelete:d,onEventAdd:r}=e,[o,c]=(0,s.useState)(null),[u,p]=(0,s.useState)(!1),[h,b]=(0,s.useState)(null),f=()=>{c(null),b(null),p(!1)},x=e=>{let{name:t,value:l}=e.target;o?c({...o,[t]:l}):h&&b({...h,[t]:l})};return(0,a.jsxs)("div",{children:[(0,a.jsx)(n.Vv,{localizer:i,events:t,startAccessor:"start",endAccessor:"end",style:{height:600},views:[n.Pp.MONTH,n.Pp.WEEK,n.Pp.DAY],selectable:!0,onSelectEvent:e=>{c(e),p(!0)},onSelectSlot:e=>{b({title:"",start:e.start,end:e.end,platform:"",status:"scheduled"}),p(!0)},eventPropGetter:e=>{let t="#3174ad";return"posted"===e.status?t="#4caf50":"failed"===e.status?t="#f44336":"scheduled"===e.status&&(t="#ff9800"),{style:{backgroundColor:t,borderRadius:"4px",color:"white",border:"none",padding:"2px 4px"}}}}),u&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 max-w-full",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:o?"Edit Event":"Add Event"}),(0,a.jsxs)("label",{className:"block mb-2",children:["Title",(0,a.jsx)("input",{type:"text",name:"title",value:o?o.title:(null==h?void 0:h.title)||"",onChange:x,className:"w-full border border-gray-300 rounded px-2 py-1"})]}),(0,a.jsxs)("label",{className:"block mb-2",children:["Platform",(0,a.jsx)("input",{type:"text",name:"platform",value:o?o.platform:(null==h?void 0:h.platform)||"",onChange:x,className:"w-full border border-gray-300 rounded px-2 py-1"})]}),(0,a.jsxs)("label",{className:"block mb-2",children:["Status",(0,a.jsxs)("select",{name:"status",value:o?o.status:(null==h?void 0:h.status)||"scheduled",onChange:x,className:"w-full border border-gray-300 rounded px-2 py-1",children:[(0,a.jsx)("option",{value:"scheduled",children:"Scheduled"}),(0,a.jsx)("option",{value:"posted",children:"Posted"}),(0,a.jsx)("option",{value:"failed",children:"Failed"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[o&&(0,a.jsx)("button",{onClick:()=>{o&&(d(o.id),f())},className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",children:"Delete"}),(0,a.jsx)("button",{onClick:()=>{o?l(o):h&&r(h),f()},className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Save"}),(0,a.jsx)("button",{onClick:f,className:"bg-gray-300 px-4 py-2 rounded hover:bg-gray-400",children:"Cancel"})]})]})})]})}function u(){let[e,t]=(0,s.useState)([]),[l,n]=(0,s.useState)(!0),r=(0,s.useCallback)(async()=>{n(!0);let{data:e,error:l}=await d.from("scheduled_posts").select("*").order("scheduled_at",{ascending:!0});!l&&e&&t(e.map(e=>({id:e.id,title:e.content.substring(0,20)+(e.content.length>20?"...":""),start:new Date(e.scheduled_at),end:new Date(e.scheduled_at),platform:e.platform,status:e.status}))),n(!1)},[]);(0,s.useEffect)(()=>{r()},[r]);let o=async e=>{try{let l=await fetch("/api/scheduler/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!l.ok)throw Error("Failed to add event");let a=await l.json();t(t=>[...t,{id:a[0].id,title:e.title,start:new Date(e.start),end:new Date(e.end),platform:e.platform,status:e.status}])}catch(e){console.error("Add event error:",e),alert("Failed to add event")}},i=async e=>{try{let l=await fetch("/api/scheduler/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!l.ok)throw Error("Failed to update event");await l.json(),t(t=>t.map(t=>t.id===e.id?e:t))}catch(e){console.error("Update event error:",e),alert("Failed to update event")}},u=async e=>{try{if(!(await fetch("/api/scheduler/delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})})).ok)throw Error("Failed to delete event");t(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Delete event error:",e),alert("Failed to delete event")}};return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Content Scheduler"}),l?(0,a.jsx)("p",{children:"Loading scheduled posts..."}):(0,a.jsx)(c,{events:e,onEventAdd:o,onEventUpdate:i,onEventDelete:u})]})}},45832:(e,t,l)=>{Promise.resolve().then(l.bind(l,24997))}},e=>{var t=t=>e(e.s=t);e.O(0,[431,96,358],()=>t(45832)),_N_E=e.O()}]);