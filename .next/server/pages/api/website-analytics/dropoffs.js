"use strict";(()=>{var e={};e.id=445,e.ids=[445],e.modules={8667:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return i}});var i=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},33480:(e,t,i)=>{e.exports=i(75600)},66809:(e,t,i)=>{i.r(t),i.d(t,{config:()=>u,default:()=>d,routeModule:()=>f});var r={};i.r(r),i.d(r,{default:()=>c});var o=i(33480),s=i(8667),a=i(86435);let n=[{id:"1",page_path:"/collections/hoodies",drop_off_type:"filter",drop_off_rate:36.5,affected_users_count:1247,revenue_impact:18500,ai_insight:"Users exit when filtering by price below 1000 EGP. Consider adjusting price ranges or adding more affordable options.",severity:"high",created_at:"2024-01-15T10:00:00Z",updated_at:"2024-01-15T10:00:00Z"},{id:"2",page_path:"/products/bape-shark-hoodie",drop_off_type:"product",drop_off_rate:28.3,affected_users_count:892,revenue_impact:12500,ai_insight:"Product page lacks size guide visibility. Users exit when they can't find sizing information easily.",severity:"medium",created_at:"2024-01-15T11:00:00Z",updated_at:"2024-01-15T11:00:00Z"},{id:"3",page_path:"/collections/new-arrivals",drop_off_type:"collection",drop_off_rate:42.1,affected_users_count:2156,revenue_impact:28750,ai_insight:"Collection page has slow loading times and poor mobile optimization. Users exit before content loads.",severity:"critical",created_at:"2024-01-15T12:00:00Z",updated_at:"2024-01-15T12:00:00Z"},{id:"4",page_path:"/checkout",drop_off_type:"checkout",drop_off_rate:18.7,affected_users_count:567,revenue_impact:8500,ai_insight:"Checkout process has too many steps. Consider implementing one-click checkout or guest checkout options.",severity:"medium",created_at:"2024-01-15T13:00:00Z",updated_at:"2024-01-15T13:00:00Z"}];async function c(e,t){if("GET"===e.method)try{let{severity:i,drop_off_type:r,page_path:o}=e.query,s=[...n];i&&(s=s.filter(e=>e.severity===i)),r&&(s=s.filter(e=>e.drop_off_type===r)),o&&(s=s.filter(e=>e.page_path.includes(o)));let a={total_dropoffs:s.length,total_revenue_impact:s.reduce((e,t)=>e+t.revenue_impact,0),average_drop_off_rate:(s.reduce((e,t)=>e+t.drop_off_rate,0)/s.length).toFixed(1),critical_issues:s.filter(e=>"critical"===e.severity).length,high_priority_issues:s.filter(e=>"high"===e.severity).length};t.status(200).json({success:!0,data:s,summary:a,recommendations:function(e){let t=[],i=e.filter(e=>"critical"===e.severity),r=e.filter(e=>"high"===e.severity);return i.length>0&&t.push("Immediate action required: Address critical drop-off issues affecting revenue"),r.length>0&&t.push("Prioritize high-severity drop-offs for optimization"),e.filter(e=>"filter"===e.drop_off_type).length>0&&t.push("Review and optimize filter functionality across collection pages"),e.filter(e=>"checkout"===e.drop_off_type).length>0&&t.push("Streamline checkout process to reduce abandonment"),e.filter(e=>"product"===e.drop_off_type).length>0&&t.push("Enhance product pages with better information and CTAs"),t}(s)})}catch(e){t.status(500).json({success:!1,error:"Failed to fetch drop-offs"})}else if("POST"===e.method)try{let i=e.body,r=await p(i),o={id:Date.now().toString(),...i,ai_insight:r.insight,severity:r.severity,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};n.push(o),t.status(201).json({success:!0,data:o,ai_analysis:r})}catch(e){t.status(500).json({success:!1,error:"Failed to create drop-off record"})}else t.setHeader("Allow",["GET","POST"]),t.status(405).json({success:!1,error:`Method ${e.method} Not Allowed`})}async function p(e){let t="low",i="";switch(e.drop_off_rate>40||e.revenue_impact>2e4?t="critical":e.drop_off_rate>25||e.revenue_impact>1e4?t="high":(e.drop_off_rate>15||e.revenue_impact>5e3)&&(t="medium"),e.drop_off_type){case"filter":i=`Users exit when filtering by ${e.page_path.includes("price")?"price":"category"}. Consider adjusting filter options or improving filter UX.`;break;case"product":i=`Product page ${e.page_path} has usability issues. Consider adding size guides, better images, or clearer CTAs.`;break;case"checkout":i=`Checkout process on ${e.page_path} is causing abandonment. Consider simplifying the process or adding guest checkout.`;break;case"collection":i=`Collection page ${e.page_path} has performance issues. Consider optimizing loading speed and mobile experience.`;break;default:i=`Users are exiting from ${e.page_path}. Review page content and user experience.`}return{severity:t,insight:i,confidence:.88,suggested_actions:function(e,t){let i=[];switch("critical"===t&&i.push("Immediate optimization required"),e){case"filter":i.push("Review filter options and pricing ranges"),i.push("Add more filter categories"),i.push("Improve filter UI/UX");break;case"product":i.push("Add size guide popup"),i.push("Improve product images"),i.push("Add customer reviews section");break;case"checkout":i.push("Implement one-click checkout"),i.push("Add guest checkout option"),i.push("Simplify checkout form");break;case"collection":i.push("Optimize page loading speed"),i.push("Improve mobile responsiveness"),i.push("Add better product grid layout")}return i}(e.drop_off_type,t)}}let d=(0,a.M)(r,"default"),u=(0,a.M)(r,"config"),f=new o.PagesAPIRouteModule({definition:{kind:s.A.PAGES_API,page:"/api/website-analytics/dropoffs",pathname:"/api/website-analytics/dropoffs",bundlePath:"",filename:""},userland:r})},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},86435:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,i){return i in t?t[i]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,i)):"function"==typeof t&&"default"===i?t:void 0}}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var i=t(t.s=66809);module.exports=i})();