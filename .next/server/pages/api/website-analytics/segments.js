"use strict";(()=>{var e={};e.id=974,e.ids=[974],e.modules={8667:(e,s)=>{Object.defineProperty(s,"A",{enumerable:!0,get:function(){return n}});var n=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},33480:(e,s,n)=>{e.exports=n(75600)},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},86435:(e,s)=>{Object.defineProperty(s,"M",{enumerable:!0,get:function(){return function e(s,n){return n in s?s[n]:"then"in s&&"function"==typeof s.then?s.then(s=>e(s,n)):"function"==typeof s&&"default"===n?s:void 0}}})},94401:(e,s,n)=>{n.r(s),n.d(s,{config:()=>d,default:()=>u,routeModule:()=>l});var o={};n.r(o),n.d(o,{default:()=>c});var t=n(33480),r=n(8667),i=n(86435);let a=[{segment:"Returning users on iPhone",sessions:456,conversionRate:.084,averageOrderValue:299,bounceRate:.23,aiInsight:"High-value segment with strong mobile engagement",trend:"up",lastUpdated:new Date,deviceBreakdown:{mobile:{sessions:456,conversionRate:.084,revenue:136344},desktop:{sessions:0,conversionRate:0,revenue:0},tablet:{sessions:0,conversionRate:0,revenue:0}},sourceBreakdown:{social:{sessions:342,conversionRate:.088,revenue:102816},organic:{sessions:68,conversionRate:.074,revenue:20400},paid:{sessions:46,conversionRate:.087,revenue:13128}}},{segment:"New users on Android",sessions:234,conversionRate:.052,averageOrderValue:245,bounceRate:.41,aiInsight:"Lower conversion rate suggests need for Android UX optimization",trend:"down",lastUpdated:new Date,deviceBreakdown:{mobile:{sessions:234,conversionRate:.052,revenue:30420},desktop:{sessions:0,conversionRate:0,revenue:0},tablet:{sessions:0,conversionRate:0,revenue:0}},sourceBreakdown:{social:{sessions:175,conversionRate:.054,revenue:22750},organic:{sessions:35,conversionRate:.049,revenue:4550},paid:{sessions:24,conversionRate:.05,revenue:3120}}},{segment:"Desktop users from Google",sessions:189,conversionRate:.068,averageOrderValue:345,bounceRate:.28,aiInsight:"High AOV but moderate conversion rate. Consider desktop optimization",trend:"stable",lastUpdated:new Date,deviceBreakdown:{mobile:{sessions:0,conversionRate:0,revenue:0},desktop:{sessions:189,conversionRate:.068,revenue:65205},tablet:{sessions:0,conversionRate:0,revenue:0}},sourceBreakdown:{social:{sessions:0,conversionRate:0,revenue:0},organic:{sessions:189,conversionRate:.068,revenue:65205},paid:{sessions:0,conversionRate:0,revenue:0}}},{segment:"Tablet users from Facebook",sessions:67,conversionRate:.075,averageOrderValue:289,bounceRate:.31,aiInsight:"Strong tablet performance with good social media engagement",trend:"up",lastUpdated:new Date,deviceBreakdown:{mobile:{sessions:0,conversionRate:0,revenue:0},desktop:{sessions:0,conversionRate:0,revenue:0},tablet:{sessions:67,conversionRate:.075,revenue:19363}},sourceBreakdown:{social:{sessions:67,conversionRate:.075,revenue:19363},organic:{sessions:0,conversionRate:0,revenue:0},paid:{sessions:0,conversionRate:0,revenue:0}}},{segment:"Returning users on Desktop",sessions:123,conversionRate:.089,averageOrderValue:378,bounceRate:.19,aiInsight:"Highest AOV segment with excellent desktop experience",trend:"up",lastUpdated:new Date,deviceBreakdown:{mobile:{sessions:0,conversionRate:0,revenue:0},desktop:{sessions:123,conversionRate:.089,revenue:46494},tablet:{sessions:0,conversionRate:0,revenue:0}},sourceBreakdown:{social:{sessions:92,conversionRate:.092,revenue:34776},organic:{sessions:18,conversionRate:.083,revenue:6804},paid:{sessions:13,conversionRate:.077,revenue:4914}}},{segment:"New users on iPhone",sessions:178,conversionRate:.061,averageOrderValue:267,bounceRate:.35,aiInsight:"Good mobile performance for new users, room for optimization",trend:"stable",lastUpdated:new Date,deviceBreakdown:{mobile:{sessions:178,conversionRate:.061,revenue:47526},desktop:{sessions:0,conversionRate:0,revenue:0},tablet:{sessions:0,conversionRate:0,revenue:0}},sourceBreakdown:{social:{sessions:134,conversionRate:.063,revenue:35742},organic:{sessions:27,conversionRate:.056,revenue:7209},paid:{sessions:17,conversionRate:.059,revenue:4575}}}];async function c(e,s){if("GET"!==e.method)return s.status(405).json({error:"Method not allowed"});try{await new Promise(e=>setTimeout(e,110));let n=[...a],{device:o,source:t,userType:r,conversionRate:i}=e.query;if(o&&"all"!==o&&(n=n.filter(e=>e.segment.toLowerCase().includes(o))),t&&"all"!==t&&(n=n.filter(e=>e.segment.toLowerCase().includes(t))),r&&"all"!==r&&(n=n.filter(e=>e.segment.toLowerCase().includes(r))),i){let e=parseFloat(i);n=n.filter(s=>s.conversionRate>=e)}let c=n.length,u=n.reduce((e,s)=>e+s.sessions,0),d=n.reduce((e,s)=>e+s.conversionRate,0)/c,l=n.reduce((e,s)=>e+s.averageOrderValue,0)/c,v=n.reduce((e,s)=>e+s.sessions*s.conversionRate*s.averageOrderValue,0),g={bestConvertingSegment:n.sort((e,s)=>s.conversionRate-e.conversionRate)[0],highestValueSegment:n.sort((e,s)=>s.averageOrderValue-e.averageOrderValue)[0],devicePerformance:{mobile:{sessions:n.filter(e=>e.segment.includes("iPhone")||e.segment.includes("Android")).reduce((e,s)=>e+s.sessions,0),avgConversionRate:n.filter(e=>e.segment.includes("iPhone")||e.segment.includes("Android")).reduce((e,s)=>e+s.conversionRate,0)/n.filter(e=>e.segment.includes("iPhone")||e.segment.includes("Android")).length},desktop:{sessions:n.filter(e=>e.segment.includes("Desktop")).reduce((e,s)=>e+s.sessions,0),avgConversionRate:n.filter(e=>e.segment.includes("Desktop")).reduce((e,s)=>e+s.conversionRate,0)/n.filter(e=>e.segment.includes("Desktop")).length},tablet:{sessions:n.filter(e=>e.segment.includes("Tablet")).reduce((e,s)=>e+s.sessions,0),avgConversionRate:n.filter(e=>e.segment.includes("Tablet")).reduce((e,s)=>e+s.conversionRate,0)/n.filter(e=>e.segment.includes("Tablet")).length}},sourcePerformance:{social:{sessions:n.filter(e=>e.segment.includes("Facebook")||e.segment.includes("social")).reduce((e,s)=>e+s.sessions,0),avgConversionRate:n.filter(e=>e.segment.includes("Facebook")||e.segment.includes("social")).reduce((e,s)=>e+s.conversionRate,0)/n.filter(e=>e.segment.includes("Facebook")||e.segment.includes("social")).length},organic:{sessions:n.filter(e=>e.segment.includes("Google")).reduce((e,s)=>e+s.sessions,0),avgConversionRate:n.filter(e=>e.segment.includes("Google")).reduce((e,s)=>e+s.conversionRate,0)/n.filter(e=>e.segment.includes("Google")).length}}},m=[],R=n.filter(e=>e.conversionRate<.06);R.length>0&&m.push({type:"optimization",priority:"high",segments:R.map(e=>e.segment),action:"Focus on improving conversion rates for low-performing segments"});let p=n.filter(e=>e.averageOrderValue>300);return p.length>0&&m.push({type:"opportunity",priority:"medium",segments:p.map(e=>e.segment),action:"Leverage high-value segments for targeted marketing campaigns"}),s.status(200).json({success:!0,data:{segments:n,metrics:{totalSegments:c,totalSessions:u,avgConversionRate:Math.round(1e3*d)/1e3,avgOrderValue:Math.round(l),totalRevenue:Math.round(v)},insights:g,recommendations:m}})}catch(e){return console.error("Segments API error:",e),s.status(500).json({success:!1,error:"Failed to load segment data"})}}let u=(0,i.M)(o,"default"),d=(0,i.M)(o,"config"),l=new t.PagesAPIRouteModule({definition:{kind:r.A.PAGES_API,page:"/api/website-analytics/segments",pathname:"/api/website-analytics/segments",bundlePath:"",filename:""},userland:o})}};var s=require("../../../webpack-api-runtime.js");s.C(e);var n=s(s.s=94401);module.exports=n})();