"use strict";(()=>{var e={};e.id=2493,e.ids=[2493],e.modules={8667:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return a}});var a=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},13578:(e,t,a)=>{a.r(t),a.d(t,{config:()=>d,default:()=>u,routeModule:()=>c});var i={};a.r(i),a.d(i,{default:()=>l});var o=a(33480),s=a(8667),n=a(86435);let r=[{id:"deal_001",name:"Tech Solutions Marketing Package",lead:"Ahmed Hassan",value:5e4,stage:"Proposal",probability:75,closeDate:"2024-02-15",owner:"Sales Team",products:["Social Media Management","Content Creation","Analytics"],notes:"Comprehensive marketing solution for tech company",activities:[{type:"proposal",date:"2024-01-20",value:5e4},{type:"meeting",date:"2024-01-18",notes:"Requirements discussion"}]},{id:"deal_002",name:"Fashion Retail Social Media",lead:"Sara Mahmoud",value:25e3,stage:"Discovery",probability:40,closeDate:"2024-03-01",owner:"Sales Team",products:["Social Media Management","Content Creation"],notes:"Basic social media management for retail startup",activities:[{type:"discovery",date:"2024-01-22",notes:"Initial meeting"}]},{id:"deal_003",name:"Restaurant Marketing Automation",lead:"Mohamed Ali",value:15e3,stage:"Negotiation",probability:90,closeDate:"2024-01-30",owner:"Sales Team",products:["Marketing Automation","Social Media"],notes:"Ready to close, finalizing contract terms",activities:[{type:"negotiation",date:"2024-01-23",notes:"Contract discussion"},{type:"proposal",date:"2024-01-22",value:15e3}]}];function l(e,t){if("GET"===e.method){let{stage:a,owner:i,search:o,minValue:s,maxValue:n}=e.query,l=[...r];if(a&&(l=l.filter(e=>e.stage===a)),i&&(l=l.filter(e=>e.owner===i)),o){let e=o.toString().toLowerCase();l=l.filter(t=>t.name.toLowerCase().includes(e)||t.lead.toLowerCase().includes(e)||t.products.some(t=>t.toLowerCase().includes(e)))}s&&(l=l.filter(e=>e.value>=Number(s))),n&&(l=l.filter(e=>e.value<=Number(n))),t.status(200).json({success:!0,data:l,total:l.length,summary:{totalValue:l.reduce((e,t)=>e+t.value,0),averageValue:Math.round(l.reduce((e,t)=>e+t.value,0)/l.length),averageProbability:Math.round(l.reduce((e,t)=>e+t.probability,0)/l.length),highProbabilityDeals:l.filter(e=>e.probability>80).length,expectedValue:l.reduce((e,t)=>e+t.value*t.probability/100,0)}})}else if("POST"===e.method){let a={id:`deal_${Date.now()}`,...e.body,activities:[]};r.push(a),t.status(201).json({success:!0,data:a,message:"Deal created successfully"})}else if("PUT"===e.method){let{id:a}=e.query,i=r.findIndex(e=>e.id===a);if(-1===i)return t.status(404).json({error:"Deal not found"});r[i]={...r[i],...e.body},t.status(200).json({success:!0,data:r[i],message:"Deal updated successfully"})}else if("DELETE"===e.method){let{id:a}=e.query,i=r.findIndex(e=>e.id===a);if(-1===i)return t.status(404).json({error:"Deal not found"});r.splice(i,1),t.status(200).json({success:!0,message:"Deal deleted successfully"})}else t.setHeader("Allow",["GET","POST","PUT","DELETE"]),t.status(405).json({error:"Method not allowed"})}let u=(0,n.M)(i,"default"),d=(0,n.M)(i,"config"),c=new o.PagesAPIRouteModule({definition:{kind:s.A.PAGES_API,page:"/api/crm/deals",pathname:"/api/crm/deals",bundlePath:"",filename:""},userland:i})},33480:(e,t,a)=>{e.exports=a(75600)},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},86435:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,a){return a in t?t[a]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,a)):"function"==typeof t&&"default"===a?t:void 0}}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var a=t(t.s=13578);module.exports=a})();